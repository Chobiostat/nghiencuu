<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Y tế Công cộng - Tìm giá trị khớp với Regex trong R</title>
  <link rel="shortcut icon" href="/assets/images/favicon.ico">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="alternate" type="application/rss+xml" title="Y tế Công cộng" href="/feed.xml">
  <link rel="stylesheet" href="/assets/css/highlight.css">
  <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>Tìm giá trị khớp với Regex trong R - Y tế Công cộng</title>
<meta property="og:title" content="Tìm giá trị khớp với Regex trong R" />
<meta name="description" content="  regex: regular expression (Xem một số lệnh regex cơ bản ở đây)" />
<meta property="og:description" content="  regex: regular expression (Xem một số lệnh regex cơ bản ở đây)" />
<link rel="canonical" href="http://www.ytecongcong.com//2016/09/regex-can-ban/" />
<meta property="og:url" content="http://www.ytecongcong.com//2016/09/regex-can-ban/" />
<meta property="og:site_name" content="Y tế Công cộng" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-09-18T00:00:00+02:00" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Tìm giá trị khớp với Regex trong R",
    "datePublished": "2016-09-18T00:00:00+02:00",
    "description": "  regex: regular expression (Xem một số lệnh regex cơ bản ở đây)",
    "url": "http://www.ytecongcong.com//2016/09/regex-can-ban/"
  }
</script>
<!-- End Jekyll SEO tag -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-2468850238077688",
      enable_page_level_ads: true
    });
  </script>
</head>
<body>

  <nav class="main-nav">
    
        <a href="/"> <span class="arrow">←</span>&#x2302; </a>
    

    <!--  -->
        <a href="http://stats.ytecongcong.com">? </a>
    <!--  -->
    <!-- 
        <a href="/about">? </a>
     -->
    
        <a href="/search">&#128270; </a>
    
    
        <a href="/glossary">&#x2608; </a>
    
    
        <a href="/archive">&#9776; </a>
    
    <a href="/feed.xml">&#9829;</a>
    <!-- <a class="cta" href="/feed.xml">&#9829;</a> -->
</nav>


  

  <section id="wrapper" class="">
    <article class="post">
    <header>
        <h1>Tìm giá trị khớp với Regex trong R</h1>
        <h2 class="headline">September 18, 2016</h2>
    </header>
    <section id="post-body">
      <blockquote>
  <p><code class="highlighter-rouge">regex</code>: regular expression (Xem một số lệnh regex cơ bản <a href="http://www.ytecongcong.com/2016/09/nh%E1%BA%AFc-bai-regex/">ở đây</a>)</p>
</blockquote>

<p><code class="highlighter-rouge">regex</code> là ngôn ngữ mạnh mẽ để tìm kiếm giá trị khớp với một điều kiện mong muốn được sử dụng trong hầu hết các phần mềm và ngôn ngữ lập trình. Ví dụ như tìm Google cũng là một dạng của <code class="highlighter-rouge">regex</code>. Trong phân tích dữ kiện, <code class="highlighter-rouge">regex</code> cực kỳ hữu ích để xử lý nhanh, mã hóa và chọn lọc dữ kiện. V.d. để tìm những người trả lời “không” trong một câu hỏi mở, bạn có thể tìm với cú pháp như <code class="highlighter-rouge">*[kK]hông*</code> để bao hàm tất cả những đáp án như <code class="highlighter-rouge">không</code>, <code class="highlighter-rouge">Không</code>, <code class="highlighter-rouge">không tui không biết</code>,…Dưới đây là sơ lược về ứng dụng trong R.</p>

<p>R cung cấp 7 hàm <code class="highlighter-rouge">regex</code> trong package có sẵn <code class="highlighter-rouge">base</code>. Tất cả đều mặc định là phân biệt chữ hoa chữ thường. Nếu không muốn chỉ cần chọn thêm tham số <code class="highlighter-rouge">ignore.case=TRUE</code>. Để tránh các lỗi không tương thích với các phiên bản R khác nhau, khi dùng lệnh R nên gán tham số <code class="highlighter-rouge">perl=TRUE</code>.</p>

<h2 id="tm-gi-tr-trong-cc-vector-k-t">Tìm giá trị trong các vector ký tự</h2>

<p>Hàm <code class="highlighter-rouge">grep</code> lấy tham số đầu tiên là <code class="highlighter-rouge">regex</code>, và tham số thứ hai là vector chứa nội dung cần tìm. Nếu thêm tham số <code class="highlighter-rouge">value=FALSE</code> hoặc không dùng tham số này hàm <code class="highlighter-rouge">grep</code> trả về một vector các vị trí trong vector khớp với <code class="highlighter-rouge">regex</code>. Cách này là đủ dùng nếu bạn chắc về cú pháp <code class="highlighter-rouge">regex</code> và dữ kiện có thể xử lý ngay dựa trên các giá trị này. Nếu chọn <code class="highlighter-rouge">value=TRUE</code>, <code class="highlighter-rouge">grep</code> trả về một vector với giá trị khớp có trong vector, cách này có thể giúp kiểm tra xem cú pháp lệnh mình tìm có đúng hay không.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="s2">"a+"</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"abc"</span><span class="p">,</span><span class="w"> </span><span class="s2">"def"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cba a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"aa"</span><span class="p">),</span><span class="w"> </span><span class="n">perl</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">1</span><span class="w">     </span><span class="m">3</span><span class="w">       </span><span class="m">4</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="s2">"a+"</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"abc"</span><span class="p">,</span><span class="w"> </span><span class="s2">"def"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cba a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"aa"</span><span class="p">),</span><span class="w"> </span><span class="n">perl</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="s2">"abc"</span><span class="w"> </span><span class="s2">"cba a"</span><span class="w"> </span><span class="s2">"aa"</span><span class="w">
</span></code></pre>
</div>

<p>Hàm <code class="highlighter-rouge">grepl</code> dùng giống như hàm <code class="highlighter-rouge">grep</code>, ngoại trừ việc tham số <code class="highlighter-rouge">value</code> không xài được. <code class="highlighter-rouge">grepl</code> trả về một vector đúng/sai với cùng độ dài với vector đầu vào. Mỗi giá trị trong vector trả về cho biết vị trí tương ứng trong vector đầu vào có khớp với <code class="highlighter-rouge">regex</code> không.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">grepl</span><span class="p">(</span><span class="s2">"a+"</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"abc"</span><span class="p">,</span><span class="w"> </span><span class="s2">"def"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cba a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"aa"</span><span class="p">),</span><span class="w"> </span><span class="n">perl</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="kc">TRUE</span><span class="w">  </span><span class="kc">FALSE</span><span class="w"> </span><span class="kc">TRUE</span><span class="w">  </span><span class="kc">TRUE</span><span class="w">
</span></code></pre>
</div>

<p>Hàm <code class="highlighter-rouge">regexpr</code> nhận tham số giống <code class="highlighter-rouge">grepl</code>, nhưng trả về một vector số nguyên cùng độ dài với vector đầu vào. Mỗi giá trị cho biết vị trí ký tự đầu tiên khớp với tìm kiếm trong mỗi chuỗi tương ứng. V.d. khớp ngay vị trí đầu tiên sẽ trả về giá trị <code class="highlighter-rouge">1</code>. Nếu không có giá trị nào khớp giá trị trả về là <code class="highlighter-rouge">-1</code>. V.d. bên dưới <code class="highlighter-rouge">"cba a"</code> có ký tự <code class="highlighter-rouge">a</code> đầu tiên ở vị trí số 3.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">regexpr</span><span class="p">(</span><span class="s2">"a+"</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"abc"</span><span class="p">,</span><span class="w"> </span><span class="s2">"def"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cba a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"aa"</span><span class="p">),</span><span class="w"> </span><span class="n">perl</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="m">-1</span><span class="w">  </span><span class="m">3</span><span class="w">  </span><span class="m">1</span><span class="w">
</span><span class="nf">attr</span><span class="p">(,</span><span class="s2">"match.length"</span><span class="p">)</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="m">-1</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">2</span><span class="w">
</span></code></pre>
</div>

<p>Các lệnh trên là tương đối đủ dùng cho các dữ kiện bình thường, ngoài ra còn có hàm <code class="highlighter-rouge">gregexpr</code> gần giống như <code class="highlighter-rouge">regexpr</code>, hàm <code class="highlighter-rouge">regmatches</code> dùng để lấy giá trị thật của chuỗi khớp với <code class="highlighter-rouge">regex</code>. V.d.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"abc"</span><span class="p">,</span><span class="w"> </span><span class="s2">"def"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cba a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"aa"</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">regexpr</span><span class="p">(</span><span class="s2">"a+"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">perl</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">regmatches</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">  </span><span class="s2">"a"</span><span class="w">  </span><span class="s2">"a"</span><span class="w">  </span><span class="s2">"aa"</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gregexpr</span><span class="p">(</span><span class="s2">"a+"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">perl</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">regmatches</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w">
</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span><span class="w">  </span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="s2">"a"</span><span class="w">
</span><span class="p">[[</span><span class="m">2</span><span class="p">]]</span><span class="w">  </span><span class="n">character</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w">
</span><span class="p">[[</span><span class="m">3</span><span class="p">]]</span><span class="w">  </span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="s2">"a"</span><span class="w">   </span><span class="s2">"a"</span><span class="w">
</span><span class="p">[[</span><span class="m">4</span><span class="p">]]</span><span class="w">  </span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="s2">"aa"</span><span class="w">
</span></code></pre>
</div>

<p>Giá trị, hoặc vị trí trả về qua tìm kiếm với các hàm trên có thể dùng để lọc, thay thế, chỉnh sửa giá trị trong dữ kiện theo mong muốn với cách căn bản như dùng như <code class="highlighter-rouge">x[vector vị trí] &lt;- vector thay thế</code> hoặc với hàm <code class="highlighter-rouge">sub, gsub</code></p>

    </section>
      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- bottompost -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2468850238077688"
     data-ad-slot="3417412256"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

      <style>
.askbutton {
  display: inline-block;
  border-radius: 4px;
  background-color: #F25056;
  border: none;
  color: #FFFFFF;
  /*text-align: center;*/
  font-size: 24px;
  padding: 6px;
  width: 80%;
  transition: all 0.5s;
  cursor: pointer;
  margin-left: auto;
  margin-right: auto;
}

.askbutton span {
  cursor: pointer;
  display: inline-block;
  position: relative;
  transition: 0.5s;
}

.askbutton span:after {
  content: '»';
  position: absolute;
  opacity: 0;
  top: 0;
  right: -20px;
  transition: 0.5s;
}

.askbutton:hover span {
  padding-right: 25px;
}

.askbutton:hover span:after {
  opacity: 1;
  right: 0;
}
</style>
<div style="display: block;
    text-align: center; margin-top: 10px; ">
<form method="post" action="http://stats.ytecongcong.com/ask">
<button type="submit" class="askbutton" style="vertical-align:middle"><span>Đặt câu hỏi </span></button>
<input type="hidden" name="doask1" value="1"></form>
</div>

</article>

<div class="PageNavigation">
  
    <a class="prev" href="/2016/09/cach-vi%E1%BA%BFt-markdown/">&laquo; Cách viết Markdown</a>
  
  
    <a class="next" href="/2016/09/nh%E1%BA%AFc-bai-regex/">Nhắc bài Regex &raquo;</a>
  
</div>

<footer id="post-meta" class="clearfix">
    <a href="/">
        <img class="avatar" src="/assets/images/avatar.png">
        <div>
            <span class="dark">Y tế Công cộng</span>
            <span>Gieo sức khỏe - Gặt niềm tin</span>
        </div>
    </a>

    <section id="sharing">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=www.ytecongcong.com/2016/09/regex-can-ban/ - Tìm giá trị khớp với Regex trong R by @"><span class="icon-twitter"> Tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>
    </section>
</footer>

<!-- Disqus comments -->

    <div class="archive readmore">
        <h3>Comments</h3>
        <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'ytecongcong';
        var disqus_developer = 0; // developer mode is on
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>
    </div>


<h3>Bài liên quan</h3>



  </section>

  <script src="/assets/js/main.js"></script>


  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-83930831-1', 'auto');
    ga('send', 'pageview');
  </script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
